<!DOCTYPE html>
<!--suppress HtmlFormInputWithoutLabel -->
<html lang="en">
<head>
    <title>Asteroids</title>
    <meta name="gi" content="qrs.asteroids">
    <meta name="gv" content="0.1">

    <link rel="stylesheet" type="text/css" href="game.css">
    <script src="loader.js"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<div id="game-layer">
    <canvas id="game-canvas" width="500" height="500" autofocus></canvas>
    <div class="controls-c">
        <div class="alert">
            <div r-if="!v.alert" class="green">Condition: Green</div>
            <div r-if="v.alert" class="red">Condition: ALERT</div>
        </div>

        <div class="position">
            <div>
                <div class="autopilot" r-if="v.autopilot">
                    <div>
                        <!-- Target -->
                        <span r-var="GUt.ud('8J+Orw==')"></span>
                        <span r-var="v.autopilot.system"></span> (<span r-var="v.autopilot.x"></span> X <span r-var="v.autopilot.y"></span>)
                    </div>
                    <div>
                        <!-- ETA -->
                        <span r-var="GUt.ud('8J+VnQ==')"></span>
                        <span r-var="v.autopilot.time"></span>
                    </div>
                </div>

                <div>
                    <!-- Position -->
                    <span r-var="GUt.ud('8J+TjA==')"></span>
                    <span r-var="v.system"></span> (<span r-var="v.x"></span> X <span r-var="v.y"></span>)
                </div>
                <div>
                    <!-- Speed -->
                    <span r-var="GUt.ud('4o+p')"></span>
                    <span r-var="v.s"></span> m/s (<span r-var="v.maxSpeed"></span> m/s)
                </div>
            </div>
            <div>
                <div class="controls-cargo" r-click="f.showInventory()">
                    <!-- Cargo -->
                    <span r-var="GUt.ud('8J+Tpg==')"></span>
                    <span r-var="v.inventory.sum"></span> t (<span r-var="v.inventory.capacity"></span> t)
                </div>
                <div>
                    <!-- Health -->
                    <span r-var="GUt.ud('8J+Sqg==')"></span>
                    <span r-var="v.health"></span>
                </div>
            </div>
        </div>

        <div class="buttons">
            <button id="btnMap" class="btn btn-light">
                <span r-var="GUt.ud('8J+Xuu+4jw==')"></span>
                Open map
            </button>
            <div class="drone">
                <button r-if="v.docked" class="btn btn-primary" r-click="f.launch()">
                    <span r-var="GUt.ud('8J+Vue+4jw==')"></span>
                    Launch drone
                </button>
                <button r-if="!v.docked && v.inRange" class="btn btn-primary" r-click="f.dock()">
                    <span r-var="GUt.ud('8J+Vue+4jw==')"></span>
                    Dock drone
                </button>
                <button r-if="!v.docked && !v.inRange" class="btn btn-primary" r-click="f.recall()">
                    <span r-var="GUt.ud('8J+Vue+4jw==')"></span>
                    Recall drone
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal target selection -->
<div id="modal-targetSelection" class="modal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-xl modal-fullscreen">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Where to go?</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="modal-system-map-body">
                    <div style="display: flex; flex-grow: 1; flex-direction: column">
                        <h3>System map</h3>
                        <div class="system-map-container">
                            <div class="system-map" r-attr="{&quot;style&quot;: &quot;'width: ' + v.map.max.x + 'px; height: ' + v.map.max.y + 'px;'&quot;}">
                                <div class="system" r-for="field of v.fields" r-attr="{&quot;style&quot;: &quot;'left: ' + l.field.map.x + 'px; top: ' + l.field.map.y + 'px;'&quot;}" r-click="f.gotoObject(l.field)">
                                    <span class="system-icon" r-var="l.field.icon"></span>
                                    <span  r-if="!l.field.isPlayer" class="system-name" r-var="l.field.name"></span>
                                    <span r-if="!l.field.isPlayer" class="system-distance" r-var="l.field.distanceFloor"></span>
                                    <span r-if="!l.field.isPlayer" class="system-time" r-var="l.field.time"></span>
                                    <span r-if="l.field.isPlayer"><span class="system-player system-name">You</span></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="system-selection">
                        <h3>Navigation points</h3>
                        <ul class="system-navigation-points-list">
                            <li r-for="field of v.fields">
                                <span class="map-btn" r-click="f.gotoObject(l.field)">
                                    <span r-var="l.field.icon"></span>
                                    <span r-var="l.field.name"></span> (<span r-var="l.field.distance"></span>, <span r-var="l.field.time"></span>)
                                </span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Modal inventory -->
<div id="modal-inventory" class="modal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Inventory</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <ul>
                    <li r-for="item of v.inventory.keys()">
                        <span class="map-btn">
                            <span r-var="l.item"></span>
                            (<span r-var="v.inventory.get(l.item)"></span> t)
                        </span>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>


<!-- Modal station -->
<div id="modal-station" class="modal" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><span r-var="v.station.name"></span></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <table class="table table-striped table-hover">
                    <thead>
                    <tr><th>Item</th><th>Price</th><th>Station</th><th>Player</th><th>Buy</th><th>Sell</th></tr>
                    </thead>
                    <tbody>
                    <tr r-for="item of v.items">
                        <td>
                            <span r-var="l.item.name.toUpperCase()"></span>
                        </td>
                        <td>
                            <span class="badge bg-primary">
                                <span r-var="v.station.sellingPrice(l.item.name)"></span> <span r-var="GUt.ud('8J+qmQ==')"></span>
                            </span>

                            <span class="badge bg-danger">
                                <span r-var="v.station.buyingPrice(l.item.name)"></span> <span r-var="GUt.ud('8J+qmQ==')"></span>
                            </span>
                        </td>
                        <td>
                            <span r-var="v.station.inventory.get(l.item.name)"></span> t
                        </td>
                        <td>
                            <span r-var="v.player.inventory.get(l.item.name)"></span> t
                        </td>
                        <td>
                            <button r-if="v.station.inventory.get(l.item.name) >= 1" class="btn btn-primary" r-click="f.buy(l.item.name, 1)">
                                Buy 1
                            </button>
                            <button r-if="v.station.inventory.get(l.item.name) >= 10" class="btn btn-primary" r-click="f.buy(l.item.name, 10)">
                                Buy 10
                            </button>
                            <button r-if="v.station.inventory.get(l.item.name) >= 1" class="btn btn-primary" r-click="f.buy(l.item.name, null)">
                                Buy all
                            </button>
                        </td>
                        <td>
                            <button r-if="v.player.inventory.get(l.item.name) >= 1" class="btn btn-danger" r-click="f.sell(l.item.name, 1)">
                                Sell 1
                            </button>
                            <button r-if="v.player.inventory.get(l.item.name) >= 10" class="btn btn-danger" r-click="f.sell(l.item.name, 1)">
                                Sell 10
                            </button>
                            <button r-if="v.player.inventory.get(l.item.name) >= 1" class="btn btn-danger" r-click="f.sell(l.item.name, null)">
                                Sell all
                            </button>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>


</body>
</html>
